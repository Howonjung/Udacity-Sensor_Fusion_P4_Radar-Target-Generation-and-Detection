%% Lidar NIS plotting
lidarNIS = [0.0872912, 0.264311, 0.121268, 0.0717876, 0.836466, 1.57222, 0.191707, 0.627232, 0.732839, 0.752151, 0.581035, 1.12079, 1.71901, 4.40942, 0.557855, 0.920685, 4.31214, 1.72091, 0.491656, 3.46308, 3.08358, 1.85039, 5.10999, 1.37417, 0.845428, 3.24777, 2.56902, 1.86864, 2.47043, 0.935297, 8.00536, 1.23595, 2.6675, 4.38539, 0.361901, 1.11178, 0.492294, 2.25156, 0.0697772, 0.759977, 1.22258, 1.39381, 0.905035, 0.343291, 0.0639121, 4.1926, 1.03732, 2.64066, 2.91793, 2.75762, 4.63018, 0.704763, 0.336322, 0.892544, 4.65868, 7.22865, 2.69235, 4.67072, 0.868227, 2.83753, 2.11713, 0.730076, 1.21247, 1.7938, 1.53639, 0.962438, 0.489181, 1.01725, 0.736379, 0.0534776, 1.59718, 0.184815, 0.224313, 0.445978, 0.121404, 3.70388, 1.20128, 2.81625, 1.67793, 0.788501, 2.41954, 4.84159, 6.86356, 3.42856, 3.41581, 1.97512, 4.17271, 2.72005, 2.83658, 4.59472, 0.433945, 0.820318, 0.0960581, 1.273, 1.02332, 0.0821236, 0.315972, 0.113128, 0.803645, 1.36308, 2.47751, 1.68233, 2.13217, 0.862649, 1.40815, 0.48844, 0.104889, 0.492347, 0.324918, 0.647847, 0.9023, 0.338914, 0.0514906, 0.256491, 0.666172, 0.0234101, 0.636132, 2.02616, 2.06312, 3.34552, 3.39291, 2.35052, 4.32825, 3.58357, 1.89886, 2.61491, 0.115733, 0.33854, 1.07441, 4.13455, 3.83662, 2.11197, 1.3818, 0.268482, 0.934983, 2.82674, 2.77257, 4.85932, 4.41769, 3.20128, 4.52494, 1.19102, 0.941192, 2.25595, 0.853993, 0.631416, 1.60454, 3.95088, 3.9528, 3.81593, 5.00567, 5.12515, 5.85619, 0.556741, 1.744, 0.127697, 0.317105, 1.01288, 0.124781, 1.46852, 1.15351, 0.924869, 2.26491, 3.69655, 2.45841, 0.747372, 0.698201, 0.0311757, 3.85992, 4.72417, 9.67267, 5.01879, 3.05875, 7.3201, 7.59941, 6.49849, 4.58578, 3.36953, 1.7345, 2.98015, 3.91535, 2.65803, 3.96472, 0.817329, 0.177699, 1.45495, 0.268469, 0.603612, 0.351484, 0.551769, 0.627604, 0.360151, 4.27126, 4.06723, 4.93964, 1.97441, 1.92278, 2.30931, 2.34568, 1.66491, 2.6274, 10.6101, 9.90536, 12.8704, 0.0722035, 0.243102, 0.297795, 11.0234, 11.3284, 7.12777, 3.78935, 3.57235, 8.96232, 3.20072, 3.69612, 0.532824, 3.51532, 4.53953, 3.56456, 2.00865, 1.70859, 4.53853, 0.745888, 0.462205, 0.512425, 0.753907, 2.09914, 1.68449, 1.88717, 2.63884, 3.81125, 3.78214, 4.14621, 3.97437, 10.447, 11.1072, 13.6797, 0.0960436, 0.329524, 1.02369, 0.384842, 1.35733, 0.330263, 3.55433, 1.96393, 4.91263, 3.07376, 1.22018, 5.69002, 0.966773, 2.04074, 0.752086, 0.944164, 0.596279, 3.35881, 5.00102, 4.90485, 7.00977, 1.19065, 2.57486, 0.555928, 3.79415, 4.91842, 1.1119, 1.87355, 1.93446, 1.24893, 5.31411, 5.26035, 3.62713, 0.340291, 0.538924, 0.333144, 3.71316, 3.06775, 4.61008, 0.0875341, 0.13037, 0.737836, 0.970017, 1.27373, 3.30689, 1.43444, 1.2353, 3.49392, 1.51029, 1.0444, 2.46652, 0.728487, 0.474455, 0.671821, 2.32854, 1.8926, 0.370296, 0.382007, 0.920203, 0.626062, 1.44879, 2.78737, 1.3396, 1.80719, 1.60362, 5.9998, 5.5152, 6.49019, 2.44876, 0.13685, 0.436645, 0.763145, 2.67093, 2.50167, 6.72397, 2.44612, 2.82448, 1.20108, 0.121168, 0.0311838, 1.56862, 0.343322, 0.21244, 1.33886, 0.91272, 0.974551, 2.76925, 0.771122, 0.726662, 1.04154, 0.485489, 0.756553, 1.57247, 1.27578, 1.74637, 3.54182, 2.8139, 1.75512, 0.962391, 1.84098, 0.685151, 0.605583, 4.20918, 3.09971, 2.2702, 4.75157, 2.83828, 3.83045, 2.71821, 4.71115, 4.03635, 1.97883, 2.94175, 2.13729, 6.14216, 4.0318, 3.77749, 2.65705, 0.893685, 1.93488, 2.00646, 3.73948, 2.79744, 1.18885, 2.57991, 2.70194, 1.40228, 0.552388, 1.24593, 0.2879, 0.558723, 0.169444, 1.00413, 2.45251, 2.05546, 0.831964, 0.312779, 0.308981, 0.146339, 0.794127, 0.300615, 3.72417, 3.02018, 6.03025, 4.42603, 3.18422, 1.90071, 1.14571, 1.50089, 3.30343, 1.00519, 1.93871, 0.629839, 0.15799, 0.974154, 0.791331, 0.0825359, 2.13828, 0.644123, 0.770477, 0.604323, 0.435427, 1.99726, 9.42567, 2.50094, 1.89524, 0.0278794, 1.01063, 1.05062, 4.84371, 1.2745, 4.68125, 0.823906, 3.33184, 0.865436, 4.06639, 1.68315, 1.41716, 3.89134, 1.55261, 0.151565, 2.02511, 0.14994, 1.02306, 6.05439, 1.37004, 2.18614, 0.0469597, 1.97705, 2.98227, 5.14154, 3.19618, 3.55286, 4.27427, 3.62932, 3.36844, 2.01797, 2.34361, 2.58832, 6.13673, 2.14333, 1.73426, 6.96572, 2.28571, 1.27027, 3.79138, 0.517649, 0.571202, 2.64356, 0.563221, 1.73772, 4.54525, 1.55036, 0.445891, 2.49794, 1.04606, 4.22538, 0.781869, 3.39087, 2.19689, 0.82263, 1.56228, 8.68916, 13.616, 8.19786, 0.175784, 2.6971, 0.108265, 2.20981, 0.0150776, 2.08712, 1.15713, 0.200325, 1.5612, 0.432069, 4.83368, 0.237068, 0.190553, 2.35469, 0.0873682, 3.20235, 1.41244, 2.67608, 0.251907, 0.565632, 0.498386, 0.597872, 2.38428, 0.454647, 0.178947, 0.641859, 0.0840931, 0.709361, 1.12956, 0.52307, 0.871728, 1.50956, 1.03208, 2.26322, 0.576352, 1.63332, 0.250857, 0.147162, 0.0508074, 1.01286, 0.423377, 0.910956, 0.380072, 0.784914, 0.341566, 4.93647, 5.52642, 4.90966, 5.01907, 4.75023, 4.83589, 1.80755, 5.50689, 1.65194, 1.84235, 3.82422, 2.54595, 4.51499, 7.31057, 2.88415, 3.79392, 8.11513, 3.63417, 4.36063, 4.22126, 6.37814, 2.41583, 1.69299, 3.8845, 4.738, 7.95588, 5.17408, 0.0204308, 0.324998, 0.216564, 0.12301, 0.0398155, 0.14202, 0.0387302, 0.371068, 0.694635, 0.236237, 0.836306, 0.391511, 3.0598, 1.64056, 2.95309, 8.13055, 7.84831, 4.49018, 3.04668, 4.76657, 1.23726, 1.29922, 2.15545, 0.747293, 2.1856, 1.16759, 5.51682, 1.18091, 0.820489, 1.66955, 0.510027, 0.0931969, 1.30208, 0.519407, 0.447922, 1.65547, 4.23129, 9.11628, 3.5161, 0.695803, 0.0145947, 1.07175, 1.20588, 0.381661, 2.16889, 1.2222, 0.59004, 1.00934, 3.38198, 3.97035, 4.29466, 0.021348, 0.397437, 0.00638368, 0.211025, 0.735005, 0.396987, 0.413179, 0.0672685, 0.49173, 1.98918, 3.4134, 2.1936, 1.52951, 1.39473, 1.65539, 0.994649, 1.83698, 0.806302, 10.0057, 13.493, 10.2069, 1.22211, 0.437809, 1.4125, 3.03183, 5.16213, 3.02606, 1.56778, 0.049914, 1.43968, 0.316923, 2.36351, 0.273337, 0.534624, 3.21818, 0.369433, 0.782789, 3.58694, 1.16077, 5.25395, 4.83336, 4.30386, 0.0827015, 3.59641, 0.256076, 3.5346, 7.8362, 4.35723, 8.91689, 3.79957, 8.06081, 1.76576, 1.31248, 0.862963, 3.53715, 2.94727, 1.54421, 0.72739, 2.83148, 2.25783, 0.087417, 1.73924, 0.518004, 4.61632, 5.15691, 1.88978, 6.47686, 3.86914, 3.81575, 2.4021, 0.49482, 3.19877, 0.95633, 2.93867, 0.798273, 2.20998, 4.02997, 0.492264, 2.3232, 3.27289, 6.63887, 1.34619, 0.13401, 1.08853, 1.18667, 3.31092, 0.133605, 3.05903, 7.72913, 1.6508, 2.10975, 1.3853, 1.07009, 0.270735, 3.10529, 1.94282, 0.0509304, 1.73526, 1.21344, 1.0561, 1.64063, 0.244084, 3.3265, 1.4842, 6.06017, 0.964439, 3.43734, 1.48822, 2.00114, 3.0447, 2.08636, 3.43879, 4.39546, 3.16626, 2.21532, 6.86041, 2.49846, 2.4006, 5.67517, 2.6678, 4.44113, 3.3042, 4.03791, 0.532971, 0.548726, 0.65433, 2.30221, 7.52176, 1.81257, 2.48026, 0.866281, 2.34448, 2.36524, 4.44813, 4.45106, 2.91713, 6.21945, 1.84093, 0.517352, 2.67741, 0.258794, 1.12961, 1.03398, 1.3957, 3.69085, 2.49877, 2.95109, 4.18218, 4.9493, 3.50056, 0.0289222, 0.262291, 0.188919, 1.54666, 2.50773, 1.26759, 5.86553, 4.51619, 7.04836, 1.69454, 0.414997, 1.48367, 2.83391, 5.80481, 2.94284, 0.512211, 1.85776, 0.471552, 2.32695, 4.03512, 2.81323, 3.91341, 3.14274, 4.32572, 0.211314, 1.14136, 0.342386, 1.0085, 1.20535, 0.851734, 6.26673, 3.6191, 5.38039, 0.916473, 1.72022, 1.71098, 0.935159, 1.07203, 1.22029, 0.752928, 1.76482, 1.35142, 3.44337, 4.53126, 3.65825, 1.30744, 4.02181, 1.70446, 1.59696, 1.3227, 1.12703, 4.83207, 4.82879, 5.29031, 2.38693, 0.6502, 1.87155, 2.71834, 1.09863, 2.26938, 2.02658, 0.973723, 1.71088, 6.04048, 4.88148, 5.18344, 2.20277, 3.43633, 3.22519, 5.94345, 7.33603, 7.29726, 2.80852, 2.19963, 1.75815, 2.07776, 1.49413, 2.155, 0.498232, 0.11235, 0.339327, 0.559411, 0.307614, 0.561923, 0.422747, 0.236055, 0.295851, 2.88502, 2.77672, 2.62488, 6.58036, 5.97168, 6.98828, 1.94077, 1.34091, 1.51764, 0.700473, 0.503362, 0.303857, 0.15307, 0.0267041, 0.0113653, 3.85123, 3.55881, 4.23016, 0.214177, 0.522486, 0.443695, 1.3229, 1.43288, 1.35281, 1.13386, 1.68026, 1.38188, 0.449433, 0.147291, 0.336132, 1.42488, 1.84793, 1.35888, 4.10011, 3.43653, 4.058, 0.384259, 0.604724, 0.638546, 0.0704328, 0.0221723, 0.0197215, 1.02377, 0.897564, 0.794946, 0.45148, 0.51363, 0.645864, 0.440292, 0.59429, 0.693937, 0.458378, 0.640966, 0.652901, 1.91768, 2.07197, 2.2947, 0.493929, 0.727386, 0.601528, 0.120522, 0.310772, 0.0724281, 3.70798, 4.4195, 3.9751, 0.0544985, 0.00978158, 0.125376, 1.72969, 2.01311, 2.14492, 0.521248, 0.702257, 0.516873];
lidarNIS_x = 1:length(lidarNIS);
lidarNIS_len = length(lidarNIS);

lidarNISOutliers = find(lidarNIS>5.991);
lidarNISOutliers_len = length(lidarNISOutliers)
fprintf("lidarNIS: %d, lidarNISOutliers: %d, percentage: %f \n", length(lidarNIS), length(lidarNISOutliers),length(lidarNISOutliers)/length(lidarNIS)*100)
% Lidar based constant velocity model TTC VS Lidar based constant acceleration model TTC
f1 = figure(1);
plot(lidarNIS_x,lidarNIS,'-k');
hold on;
hline = refline([0 5.991]);
hline.Color = 'r';
ylim([0,10]);
% set(gca, 'xtick', 1:18);
lgd = legend('LidarNIS', 'Chi squared 5% Threshold(df=2)');
title(['LidarNIS: ',num2str(lidarNIS_len),', LidarNISOutliers(over 5.991): ',num2str(lidarNISOutliers_len), ', Total outlier ratio: ',num2str(lidarNISOutliers_len/lidarNIS_len*100),'%'],'FontSize', 18)
xlabel('Lidar data frame', 'Fontsize', 15);
ylabel('LidarNIS ', 'Fontsize', 15);
lgd.FontSize = 13;
hold off;


%% Radar NIS plotting
radarNIS = [19.9828, 30.3441, 1.50693, 0.602133, 1.61125, 2.19532, 1.12237, 1.26557, 4.38258, 1.39153, 1.97612, 1.71016, 3.5704, 6.32313, 0.93122, 2.07294, 1.97425, 2.54878, 0.575584, 2.37356, 0.483422, 9.18246, 10.7349, 9.03472, 0.81921, 1.63338, 0.600259, 3.27266, 3.37703, 2.8428, 5.94003, 3.94539, 3.36615, 0.266757, 0.365933, 1.18483, 11.8309, 8.17331, 3.1392, 3.63047, 3.30881, 2.67889, 2.91253, 1.52386, 2.45595, 0.803486, 1.03899, 1.52572, 0.607771, 0.947514, 1.40951, 3.30284, 2.17206, 4.53271, 3.84651, 3.06441, 3.42038, 5.06579, 5.45768, 6.29482, 1.9593, 2.63406, 0.92554, 1.71809, 1.61568, 4.34859, 0.0934916, 0.161484, 2.44103, 0.987866, 1.41844, 2.40459, 2.25551, 1.81816, 3.10945, 1.84734, 1.34241, 3.50682, 2.22968, 2.5117, 1.86538, 4.17982, 2.57343, 7.3384, 3.38013, 2.86942, 5.89077, 3.93973, 5.39774, 1.87542, 0.0736882, 0.796179, 0.738999, 0.702497, 0.4413, 2.08761, 2.58005, 2.57647, 6.50469, 0.709366, 0.644118, 1.16735, 0.852871, 0.807463, 5.25376, 4.56743, 4.66512, 7.8777, 6.99399, 7.95517, 3.92137, 8.46642, 8.12826, 6.65092, 8.17067, 6.33635, 8.45171, 5.40779, 4.91028, 10.4119, 1.20554, 1.35688, 2.08314, 1.13459, 1.06233, 3.15857, 2.45108, 2.59095, 6.01549, 1.64521, 1.64283, 1.21471, 5.78254, 7.44616, 13.3622, 8.76781, 7.73544, 5.37649, 2.28823, 2.04555, 4.43913, 4.1083, 3.92631, 3.41332, 0.946104, 1.37403, 4.08187, 2.45314, 2.21216, 4.62903, 1.35584, 0.912729, 2.05251, 2.87316, 2.88194, 3.16075, 0.549421, 0.355306, 0.254053, 2.86477, 3.52302, 3.62931, 0.998802, 1.21497, 0.525728, 2.4689, 5.08884, 6.45475, 6.06624, 4.09372, 9.04657, 4.1525, 5.15427, 1.28573, 2.20182, 3.35841, 1.01554, 5.6762, 4.75965, 6.04107, 1.17009, 1.12333, 2.30906, 1.0425, 1.28179, 2.66649, 2.09556, 3.05138, 3.28492, 1.09035, 0.826989, 2.06595, 2.85126, 3.43226, 5.96497, 0.382699, 0.364405, 1.11942, 0.177301, 0.0969894, 0.695542, 0.988637, 1.57212, 1.07675, 3.44567, 1.1797, 4.00231, 1.03195, 2.86305, 1.21358, 0.757107, 0.253474, 1.00374, 5.34866, 8.39087, 5.81919, 1.1668, 0.418266, 2.20757, 11.4583, 7.9882, 15.1292, 6.44966, 4.53483, 6.62533, 5.42775, 5.70412, 6.96391, 2.52314, 2.44054, 3.62055, 0.784421, 1.08526, 0.578058, 2.78623, 2.78479, 5.66918, 15.3269, 15.3873, 11.2749, 0.288007, 0.297585, 2.27133, 2.37717, 1.86021, 0.980016, 9.86185, 9.95875, 10.2234, 6.04265, 7.22273, 6.38743, 1.69414, 0.798728, 1.52065, 3.40797, 2.53001, 4.01989, 3.63469, 5.38489, 5.69127, 5.30057, 6.3736, 7.35018, 2.53919, 3.34457, 5.00136, 2.38259, 2.33536, 1.07172, 10.0914, 9.87478, 13.9426, 0.967584, 1.04198, 2.10747, 5.01832, 4.38987, 4.85374, 1.58946, 1.46119, 3.53545, 1.83859, 2.04981, 1.17052, 0.17325, 0.212354, 3.51158, 2.77687, 2.42578, 11.6966, 9.56408, 10.2624, 34.4958, 3.35121, 2.73322, 12.0889, 2.34535, 1.45905, 2.4692, 4.01575, 8.41228, 6.55559, 1.94862, 0.417338, 4.13867, 5.71696, 3.09488, 12.0546, 3.29389, 2.68185, 4.25165, 0.974042, 0.63972, 6.25993, 1.00829, 0.542709, 5.13347, 4.68725, 5.42713, 8.47246, 11.9648, 9.28552, 18.9976, 2.0078, 0.825647, 4.54093, 1.3953, 0.283073, 2.85456, 7.43594, 9.33991, 8.33838, 0.618872, 1.74141, 0.056582, 3.2379, 3.91163, 3.43054, 0.432737, 0.753395, 0.216498, 1.40545, 1.62919, 2.51068, 1.28868, 1.23516, 1.24075, 0.823163, 0.957165, 1.66154, 4.36705, 4.55494, 6.15446, 2.75751, 2.57902, 2.00887, 0.848052, 1.20314, 1.59844, 4.2277, 4.30693, 3.55889, 2.8085, 2.45284, 2.16236, 2.53934, 2.54884, 3.77336, 1.83031, 1.96237, 1.27783, 0.455625, 0.320448, 0.637095, 3.64128, 3.27205, 3.69456, 3.41809, 2.80437, 4.28332, 1.94045, 2.98, 1.7796, 6.81524, 3.69203, 10.2234, 0.704824, 0.515245, 2.0522, 0.763022, 0.470101, 1.86152, 7.03277, 5.17244, 6.34761, 3.65445, 1.63945, 5.36146, 3.42255, 8.22628, 1.53154, 3.03183, 3.46809, 8.44049, 2.56093, 4.59655, 0.433765, 3.19392, 4.82012, 1.00446, 0.865059, 1.00607, 0.663893, 1.24155, 0.162427, 2.55024, 2.45482, 0.266269, 3.3486, 6.63697, 8.76664, 3.42969, 1.8142, 5.34008, 4.53149, 0.462138, 1.26874, 1.19652, 1.8303, 2.29218, 0.927258, 1.78603, 0.0566804, 1.89421, 1.45671, 2.03213, 0.456519, 4.96595, 5.72197, 2.94447, 5.13896, 7.74768, 3.14106, 1.87954, 2.72674, 3.38557, 0.252978, 0.186689, 1.50232, 1.88021, 2.68438, 3.82884, 3.87754, 3.34923, 2.16175, 11.7188, 10.1818, 7.73466, 1.70962, 0.492289, 2.36885, 2.61632, 2.86869, 0.627237, 13.0306, 12.4255, 6.15094, 4.15797, 2.20344, 3.10765, 7.29432, 11.7673, 7.033, 4.02595, 5.67582, 3.29249, 7.33925, 7.56083, 2.89604, 1.6043, 1.8751, 2.27915, 3.84649, 4.41808, 1.29255, 4.77388, 5.82737, 6.53045, 2.86369, 3.18999, 3.70071, 1.4539, 1.28351, 1.39314, 0.862907, 1.13376, 0.95856, 1.16649, 1.88786, 0.892136, 1.11223, 0.472944, 1.07166, 1.85362, 3.32726, 1.58401, 3.1006, 4.97301, 2.48419, 9.13954, 10.1448, 7.57928, 3.75806, 6.32708, 3.13901, 3.36306, 4.85753, 2.41477, 1.86016, 1.91209, 1.37333, 2.35169, 2.21636, 3.22237, 6.72897, 6.57787, 5.29605, 4.10468, 4.26426, 3.45784, 4.20096, 5.4313, 4.31967, 4.63086, 4.25041, 4.60852, 2.79772, 2.84631, 2.20646, 1.40419, 1.64785, 0.936895, 3.74141, 4.27051, 3.63463, 6.41551, 6.49001, 5.77953, 3.82077, 6.92175, 3.25389, 2.11109, 6.5088, 1.28453, 2.45598, 2.36073, 3.59752, 5.35287, 8.88481, 4.39911, 3.86865, 6.52238, 4.21707, 2.59088, 3.98478, 2.68748, 6.12759, 4.61052, 6.21413, 4.60807, 11.124, 4.40352, 11.2418, 18.4737, 10.4592, 4.81708, 8.06882, 4.58165, 0.331016, 2.3508, 0.243742, 10.8869, 13.7657, 10.4346, 3.38149, 4.84499, 3.19752, 5.39432, 7.20154, 5.29364, 5.7028, 6.86577, 5.40712, 1.46327, 1.12843, 1.40836, 6.19039, 6.77119, 6.08059, 0.268408, 0.0565836, 0.303589, 11.7123, 12.3543, 11.7067, 2.07238, 1.63157, 2.11156, 6.21227, 3.56965, 6.15648, 2.84935, 4.68912, 2.97124, 1.19199, 3.73939, 1.22815, 1.06218, 2.02446, 1.01346, 6.72204, 3.19189, 7.15011, 0.918816, 1.49883, 1.04563, 10.5259, 12.7858, 11.4094, 5.00198, 5.61373, 5.53639, 2.49163, 2.37117, 2.68837, 4.16059, 0.858815, 3.61825, 1.58854, 5.94502, 1.95023, 2.97834, 6.18473, 2.96867, 6.12392, 5.28784, 5.41526, 2.29538, 3.94881, 2.06384, 0.772848, 1.00437, 0.620636, 1.67455, 4.01114, 1.58301, 0.357277, 1.6269, 0.452818, 1.47785, 1.24864, 1.24206, 0.36012, 2.2012, 0.757096, 2.61452, 0.84057, 2.12075, 2.52851, 1.41598, 2.02232, 2.97284, 0.399256, 2.19942, 5.73566, 7.22969, 4.54278, 1.65196, 3.73243, 1.24063, 8.89694, 6.32557, 6.08499, 9.72422, 4.42105, 5.45061, 1.94084, 3.66521, 2.04696, 2.90658, 4.91667, 3.32399, 1.16137, 1.50036, 1.10096, 4.09618, 3.71917, 3.07114, 3.78591, 1.46803, 1.20429, 10.6882, 3.15691, 4.92768, 3.71982, 4.64251, 4.24951, 6.56423, 0.820234, 2.52242, 4.0917, 5.37668, 2.30473, 13.8416, 3.03736, 7.63685, 1.08388, 12.5196, 4.33032, 3.72047, 5.14224, 1.628, 0.610391, 2.74818, 1.86579, 3.49705, 9.29632, 7.1697, 2.73968, 4.0478, 2.03128, 8.28974, 3.39084, 5.15073, 2.10217, 3.05503, 1.71653, 4.9599, 8.80493, 9.48273, 1.76532, 1.40188, 2.74989, 9.63355, 6.17526, 6.20529, 1.33255, 2.4953, 1.01352, 1.26644, 0.664081, 0.254022, 2.38113, 0.794095, 0.461423, 10.1577, 7.22071, 8.30015, 4.55756, 3.70593, 3.10177, 0.705514, 0.228059, 0.132347, 4.81318, 1.81154, 1.30893, 8.92185, 4.75227, 7.2627, 4.39167, 2.05045, 1.3222, 3.07721, 1.2757, 2.15853, 2.86284, 3.26654, 4.29245, 0.852612, 0.361315, 0.388926, 4.16881, 5.00016, 5.34726, 0.226177, 0.679911, 0.603532, 1.42877, 1.18624, 1.87758, 4.56152, 2.60859, 1.4373, 0.735479, 1.29042, 1.95358, 6.83093, 3.14332, 2.88572, 3.40839, 2.36442, 1.22816, 9.332, 3.97996, 3.75282, 6.88883, 2.74967, 3.35509, 5.9697, 6.75472, 7.51868, 0.0656537, 1.08918, 0.773545, 5.85151, 1.98679, 2.71287, 2.64407, 1.29647, 1.06482, 4.0172, 0.855551, 0.992415, 0.234646, 1.48963, 1.91824, 7.59575, 3.27883, 4.1285, 2.22087, 1.31755, 1.125, 4.22136, 4.6382, 4.5291, 2.56492, 4.01996, 3.50873, 0.793712, 0.132957, 0.210764, 1.98103, 1.09462, 1.11389, 3.48114, 1.71366, 1.68095, 4.81358, 2.96502, 3.08268, 0.564588, 0.582272, 0.539533, 1.34015, 2.38853, 3.1072, 1.7297, 1.16815, 1.04403, 5.48938, 3.91736, 3.85702, 1.99389, 0.384311, 0.429127, 2.51887, 3.77864, 3.91793, 3.11937, 2.3176, 2.30062, 3.81025, 1.69129, 1.56574, 6.42522, 2.87059, 2.60801, 0.831724, 0.203231, 0.201463, 0.979385, 1.29687, 1.34017, 1.92368, 0.417998, 0.357739, 3.10462, 1.19944, 1.08742, 8.2155, 8.17024, 8.68126, 8.86802, 4.10536, 3.78111];
radarNIS_x = 1:length(radarNIS);
radarNIS_len = length(radarNIS);

radarNISOutliers = find(radarNIS>7.815);
radarNISOutliers_len = length(radarNISOutliers)
fprintf("radarNIS: %d, radarNISOutliers: %d, percentage: %f \n", length(radarNIS), length(radarNISOutliers),length(radarNISOutliers)/length(radarNIS)*100)
% Lidar based constant velocity model TTC VS Lidar based constant acceleration model TTC
f2 =figure(2);
plot(radarNIS_x,radarNIS,'-k');
hold on;
hline = refline([0 7.815]);
hline.Color = 'r';
ylim([0,10]);
% set(gca, 'xtick', 1:18);
lgd = legend('RadarNIS', 'Chi squared 5% Threshold(df=3)');
title(['RadarNIS: ',num2str(radarNIS_len),', RadarNISOutliers(over 7.815): ',num2str(radarNISOutliers_len), ', Total outlier ratio: ',num2str(radarNISOutliers_len/radarNIS_len*100),'%'],'FontSize', 18)
xlabel('Radar data frame', 'Fontsize', 15);
ylabel('RadarNIS ', 'Fontsize', 15);
lgd.FontSize = 13;